X <- runif(10^6)
X
n <- 10
Y <- rbinom(10^6, n, X)
mean(sqrt(Y/n) > X^2+X)
CDF <- function(U){
U^(1/3)
}
inv_cdf <- function(U){
U^(1/3)
}
n <- 10^5
X <- inv_cdf(runif(n))
inv_cdf <- function(U){
U^(1/3)
}
n <- 10^5
X <- inv_cdf(runif(n))
X
inv_cdf_X <- function(U){
U^(1/3)
}
inv_cdf_Y_x <- function(U,x){
sqrt(x*U)
}
n <- 10^5
U <- runif(n)
X <- inv_cdf(U)
Y <- inv_cdf_Y_x(U,X)
X
Y < X
Y < sqrt(X)
sum(Y < sqrt(X))
library(ggplot2)
library(tidyr)
tibble(X = X, Y = Y)
sim <- tibble(X = X, Y = Y)
sim %>% ggplot(aes(X)) + geom_histogram()
X
sim %>% ggplot(aes(X)) + geom_histogram() + geom_function(fun = function(x) 3*x^2)
sim %>% ggplot(aes(X)) + geom_histogram() + geom_function(fun = function(X) 3*X^2)
sim %>% ggplot(aes(X, y = ..density..)) + geom_histogram() + geom_function(fun = function(X) 3*X^2)
sim %>% ggplot(aes(X)) + geom_histogram() + geom_function(fun = function(X) 3*X^2) + after_stat(density)
sim %>% ggplot(aes(X, after_stat(count/sum(count)))) + geom_histogram() + geom_function(fun = function(X) 3*X^2)
sim %>% ggplot() + geom_histogram(aes(X, after_stat(count/sum(count)))) + geom_function(fun = function(X) 3*X^2)
sim %>% ggplot() + geom_histogram(aes(X, after_stat(count/sum(count)))) + geom_function(fun = function(X) X)
sim %>% ggplot() + geom_histogram(aes(X, after_stat(count/sum(count))))
sim %>% ggplot() + geom_density()
sim %>% ggplot() + geom_density(aes(X))
sim %>% ggplot() + geom_density(aes(X)) + xlim(0,0.95)
sim %>% ggplot() + geom_density(aes(X)) + xlim(0,0.99)
sim %>% ggplot() + geom_density(aes(X)) + xlim(0,0.9)
sim %>% ggplot() + geom_density(aes(X)) + xlim(0,0.8)
sim %>% ggplot() + geom_density(aes(X)) + xlim(0,0.75)
sim %>% ggplot() + geom_density(aes(X)) + xlim(0,0.5)
sim %>% ggplot() + geom_density(aes(X)) + xlim(0,0.9)
sim %>% ggplot() + geom_density(aes(X)) + geom_function(function(X) 3*X^2)
sim %>% ggplot(aes(X)) + geom_density() + geom_function(function(X) 3*X^2)
sim %>% ggplot(mapping = aes(X)) + geom_density() + geom_function(function(X) 3*X^2)
sim %>% ggplot() + geom_density() + geom_function(function(X) 3*X^2)
sim %>% ggplot() + geom_density(aes(X)) + geom_function(function(X) 3*X^2)
sim %>% ggplot() + geom_density(aes(X))# + geom_function(function(X) 3*X^2)
sim %>% ggplot(aes(X)) + geom_density()# + geom_function(function(X) 3*X^2)
bw <- 0.05
sim %>% ggplot() + geom_histogram(aes(x =X, y = after_stat(count/sum(count)/bw))
library(ggplot2)
library(ggplot2)
library(tidyr)
inv_cdf_X <- function(U){
U^(1/3)
}
inv_cdf_Y_x <- function(U,x){
sqrt(x*U)
}
n <- 10^5
U <- runif(n)
X <- inv_cdf(U)
X <- inv_cdf_X(U)
Y <- inv_cdf_Y_x(U,X)
bw <- 0.05
sim <- tibble(X = X, Y = Y)
sim %>% ggplot() + geom_histogram(aes(x =X, y = after_stat(count/sum(count)/bw)))
library(ggplot2)
library(tidyr)
inv_cdf_X <- function(U){
U^(1/3)
}
inv_cdf_Y_x <- function(U,x){
sqrt(x*U)
}
n <- 10^6
U <- runif(n)
X <- inv_cdf_X(U)
Y <- inv_cdf_Y_x(U,X)
bw <- 0.05
sim <- tibble(X = X, Y = Y)
sim %>% ggplot() + geom_histogram(aes(x =X, y = after_stat(count/sum(count)/bw)))
sim %>% ggplot() + geom_histogram(aes(x =X, y = after_stat(count/sum(count)/bw))) + geom_function(fun = function(X) 3*X^2)
library(ggplot2)
library(tidyr)
inv_cdf_X <- function(U){
U^(1/3)
}
inv_cdf_Y_x <- function(U,x){
sqrt(x*U)
}
n <- 10^5
U <- runif(n)
X <- inv_cdf_X(U)
Y <- inv_cdf_Y_x(U,X)
bw <- 0.05
sim <- tibble(X = X, Y = Y)
sim %>% ggplot() + geom_histogram(aes(x =X, y = after_stat(count/sum(count)/bw))) + geom_function(fun = function(X) 3*X^2)
library(ggplot2)
library(tidyr)
inv_cdf_X <- function(U){
U^(1/3)
}
inv_cdf_Y_x <- function(U,x){
sqrt(x*U)
}
n <- 10^5
U <- runif(n)
X <- inv_cdf_X(U)
Y <- inv_cdf_Y_x(U,X)
bw <- 0.05
sim <- tibble(X = X, Y = Y)
sim %>% ggplot() + geom_histogram(aes(x =X, y = after_stat(count/sum(count)/bw))) + geom_function(fun = function(X) 3*X^2)
Y < sqrt(X)
U2 <- runif(n)
Y <- inv_cdf_Y_x(U2,X)
library(ggplot2)
library(tidyr)
inv_cdf_X <- function(U){
U^(1/3)
}
inv_cdf_Y_x <- function(U,x){
sqrt(x*U)
}
n <- 10^5
U <- runif(n)
U2 <- runif(n)
X <- inv_cdf_X(U)
Y <- inv_cdf_Y_x(U2,X)
bw <- 0.05
sim <- tibble(X = X, Y = Y)
sim %>% ggplot() + geom_histogram(aes(x =X, y = after_stat(count/sum(count)/bw))) + geom_function(fun = function(X) 3*X^2)
Y < sqrt(X)
mean(Y < sqrt(X))
library(ggplot2)
library(tidyr)
inv_cdf_X <- function(U){
U^(1/3)
}
inv_cdf_Y_x <- function(U,x){
sqrt(x*U)
}
n <- 10^5
U <- runif(n)
U2 <- runif(n)
X <- inv_cdf_X(U)
Y <- inv_cdf_Y_x(U2,X)
bw <- 0.05
sim <- tibble(X = X, Y = Y)
sim %>% ggplot() + geom_histogram(aes(x =X, y = after_stat(count/sum(count)/bw))) + geom_function(fun = function(X) 3*X^2)
sim %>% ggplot() + geom_histogram(aes(x =X, y = after_stat(count/sum(count)/bw))) + geom_function(fun = function(X) 3*X^2) +geom_density()
sim %>% ggplot() + geom_histogram(aes(x =X, y = after_stat(count/sum(count)/bw))) + geom_function(fun = function(X) 3*X^2) +geom_density(aes(X))
sim %>% ggplot() + geom_histogram(aes(x =X, y = after_stat(count/sum(count)))) + geom_function(fun = function(X) 3*X^2) +geom_density(aes(X))
sim %>% ggplot() + geom_function(fun = function(X) 3*X^2) +geom_density(aes(X))
sim %>% ggplot() + geom_function(fun = function(X) 3*X^2) +geom_density(aes(Y))
sim %>% ggplot() + geom_function(fun = function(X) 3*Y*(1-Y^4)) +geom_density(aes(Y))
sim %>% ggplot() + geom_function(fun = function(X) 3*Y*(1-Y^4)) + geom_density(aes(Y))
sim %>% ggplot() + geom_function(fun = function(Y) 3*Y*(1-Y^4)) + geom_density(aes(Y))
library(ggplot2)
library(tidyr)
inv_cdf_X <- function(U){
U^(1/3)
}
inv_cdf_Y_x <- function(U,x){
sqrt(x*U)
}
n <- 10^5
U <- runif(n)
U2 <- runif(n)
X <- inv_cdf_X(U)
Y <- inv_cdf_Y_x(U,X)
bw <- 0.05
sim <- tibble(X = X, Y = Y)
#Comparte marginal desnsity of X with the simulated. Looks fine except for some weird tail behavior?
sim %>% ggplot() + geom_function(fun = function(X) 3*X^2) +geom_density(aes(X))
sim %>% ggplot() + geom_function(fun = function(Y) 3*Y*(1-Y^4)) + geom_density(aes(Y))
library(ggplot2)
library(tidyr)
inv_cdf_X <- function(U){
U^(1/3)
}
inv_cdf_Y_x <- function(U,x){
sqrt(x*U)
}
n <- 10^5
U <- runif(n)
U2 <- runif(n)
X <- inv_cdf_X(U)
Y <- inv_cdf_Y_x(U2,X)
bw <- 0.05
sim <- tibble(X = X, Y = Y)
#Comparte marginal desnsity of X with the simulated. Looks fine except for some weird tail behavior?
sim %>% ggplot() + geom_function(fun = function(X) 3*X^2) +geom_density(aes(X))
sim %>% ggplot() + geom_function(fun = function(Y) 3*Y*(1-Y^4)) + geom_density(aes(Y))
library(gridExtra)
#Comparte marginal desnsity of X and Y with the simulated. Looks fine except for some weird tail behavior for the simulated X's?
grid.arrange(
sim %>% ggplot() + geom_function(fun = function(X) 3*X^2) +geom_density(aes(X)),
sim %>% ggplot() + geom_function(fun = function(Y) 3*Y*(1-Y^4)) + geom_density(aes(Y))
)
# Make scatterplot
sim %>% ggplot(aes(X,Y)) + geom_point()
# Make scatterplot
sim %>% ggplot(aes(X,Y)) + geom_point(alpha = 0.01)
#5,
X < -log(Y)
#5,
mean(X < -log(Y))
