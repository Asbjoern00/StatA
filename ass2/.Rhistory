knitr::opts_chunk$set(echo = TRUE)
library(lme4)
library(dplyr)
library(ggplot2)
library(pbkrtest)
library(gridExtra)
library(nlme)
rm(list= ls())
load("assignment2.Rdata")
library(rstan)
to_stan <- "data {
int N;
vector[N] day1dummy;
vector[N] day2dummy;
vector[N] day3dummy;
vector[N] Z;
vector[N] SE;
}
parameters {
real theta_1;
real theta_2;
real theta_3;
real<lower = 0> tau;
}
transformed parameters {
real ratio_3_1 = theta_3/theta_1;
}
model {
Z ~ normal(theta_1*day1dummy + theta_2*day2dummy + theta_3*day3dummy, sqrt(tau^2 + SE^2));
}
"
write(to_stan, file = "model.stan")
library(rstan)
to_stan <- "data {
int N;
vector[N] day1dummy;
vector[N] day2dummy;
vector[N] day3dummy;
vector[N] Z;
vector[N] SE;
}
parameters {
real theta_1;
real theta_2;
real theta_3;
real<lower = 0> tau;
}
transformed parameters {
real ratio_3_1 = theta_3/theta_1;
}
model {
Z ~ normal(theta_1*day1dummy + theta_2*day2dummy + theta_3*day3dummy, sqrt(tau^2 + SE^2));
}
"
write(to_stan, file = "model.stan")
data <- list(N = length(bData$Estimate), Z=bData$Estimate, day1dummy = bData$day1dummy,
day2dummy = bData$day2dummy, day3dummy = bData$day3dummy, SE = bData$SE)
fitted <- rstan::stan("model.stan", data = data, iter = 32000, chains = 4)
fitted
traceplot(fitted, pars = c("theta_1","theta_2")
)
traceplot(fitted, pars = c("theta_1","theta_2","theta_3","tau")
traceplot(fitted, pars = c("theta_1","theta_2","theta_3","tau"))
fitted
knitr::opts_chunk$set(echo = TRUE)
library(lme4)
library(dplyr)
library(ggplot2)
library(pbkrtest)
library(gridExtra)
library(nlme)
rm(list= ls())
load("assignment2.Rdata")
summary(fitted)
fitted
data <- list(N = length(bData$Estimate), Z=bData$Estimate, day1dummy = bData$day1dummy,
day2dummy = bData$day2dummy, day3dummy = bData$day3dummy, SE = bData$SE)
fitted <- rstan::stan("model.stan", data = data, iter = 32000, chains = 4)
summary(fitted)
summary(fitted)$summary
class(fitted)
knitr::opts_chunk$set(echo = TRUE)
library(lme4)
library(dplyr)
library(ggplot2)
library(pbkrtest)
library(gridExtra)
library(nlme)
rm(list= ls())
load("assignment2.Rdata")
mod <- lmer(fluorescence ~ day*concFac-1 + (1|plate) , data = toxData)
toxData
mod <- lmer(fluorescence ~ day*conc + (1|plate) , data = toxData)
mod
model.matrix(mod)
nlmm2 <- nlme(fluorescence ~ d/(1+(conc/b)^e), data = toxData, groups=~plate,
fixed = list(b~day-1, d~day-1, e~1), random = pdDiag(b + d + e~ 1),
start = c(b=rep(5,3), d=rep(2000,3), e=rep(1.5,1)),
weights = varPower(form=~fitted(.)))
nlmm2
